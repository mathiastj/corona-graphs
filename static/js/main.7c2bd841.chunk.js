(this["webpackJsonpcorona-graphs"]=this["webpackJsonpcorona-graphs"]||[]).push([[0],{191:function(e,a,t){e.exports=t(394)},196:function(e,a,t){},198:function(e,a,t){},394:function(e,a,t){"use strict";t.r(a);var n=t(1),c=t.n(n),r=t(14),o=t.n(r),l=(t(196),t(22)),s=t.n(l),i=t(61),u=t(55),h=t(56),d=t(60),p=t(59),v=t(88),f=t(18),C=t(9),g=t(35),m=(t(198),t(89)),b=t.n(m),y=t(160),w=t(161),D=t(11),k=["#426600","#FF0010","#990000","#E0FF66","#FFFF80","#F0A3FF","#993F00","#005C31","#2BCE48","#FFCC99","#808080","#94FFB5","#8F7C00","#FFA405","#5EF1F2","#9DCC00","#FFFFFF","#C20088","#FFA8BB","#0075DC","#00998F","#740AFF","#FFFF00","#FF5005"],E=function(e){Object(d.a)(t,e);var a=Object(p.a)(t);function t(e){var n;return Object(u.a)(this,t),(n=a.call(this,e)).renderCustomizedLegend=function(e){var a=e.payload,t="",r=null;return c.a.createElement("div",{className:"customized-legend",style:{marginBottom:40}},a.map((function(e){t!==e.country?(t=e.country,r=c.a.createElement("span",{className:"Legend-country"},c.a.createElement("br",null),e.country,c.a.createElement("br",null))):r=null;var a=e.dataKey,o=e.color,l=e.label,s=n.state.disabled.includes(a);return c.a.createElement("span",null,r,c.a.createElement("span",{onClick:function(){return n.handleClick(a)},style:{marginRight:10,color:"#AAA"}},c.a.createElement(D.e,{width:20,height:20,style:{marginBottom:-5}},c.a.createElement(D.f,{cx:10,cy:10,type:"circle",size:50,fill:o})),c.a.createElement("input",{type:"checkbox",checked:!s}),c.a.createElement("span",{className:"Legend-per-country"},l)))})))},n.getMaxNonDisabled=function(){var e,a=Object(C.a)(n.state.yLabelPrioritizedKeys);try{for(a.s();!(e=a.n()).done;){var t=e.value;if(n.state.perCapita||n.state.rollingAverage){if(n.state.perCapita&&n.state.rollingAverage){if((!t.includes("total")||!t.includes("PerCapita"))&&!t.includes("PerCapitaRolling"))continue}else if(!n.state.perCapita&&n.state.rollingAverage){if(t.includes("PerCapita")||t.includes("new")&&!t.includes("Rolling"))continue}else if(n.state.perCapita&&!n.state.rollingAverage&&(!t.includes("PerCapita")||t.includes("Rolling")))continue}else if(t.includes("PerCapita")||t.includes("Rolling"))continue;var c,r=!1,o=Object(C.a)(n.state.disabled);try{for(o.s();!(c=o.n()).done;){var l=c.value;if(t.includes(l)){r=!0;break}}}catch(s){o.e(s)}finally{o.f()}if(!r)return t}}catch(s){a.e(s)}finally{a.f()}return""},n.state={scale:"linear",perCapita:!1,rollingAverage:!1},n}return Object(h.a)(t,[{key:"handleClick",value:function(e){this.state.disabled.includes(e)?this.setState({disabled:this.state.disabled.filter((function(a){return a!==e}))}):this.setState({disabled:this.state.disabled.concat(e)})}},{key:"handleOptionChange",value:function(e){this.setState({scale:e}),this.forceUpdate()}},{key:"handlePerCapitaChange",value:function(e){this.setState({perCapita:e}),this.forceUpdate()}},{key:"handleRollingAverageChange",value:function(e){this.setState({rollingAverage:e}),this.forceUpdate()}},{key:"render",value:function(){var e=this,a=this.props.dataPoints;if(!a)return null;var t=a,n=this.state.perCapita?"PerCapita":"",r=this.state.rollingAverage?"Rolling":"",o=this.getMaxNonDisabled();return c.a.createElement("div",null,c.a.createElement("div",{style:{width:"85%",display:"inline-block"}},c.a.createElement("span",{style:{float:"left","margin-left":"1rem"}},c.a.createElement("span",{onClick:function(){return e.handleOptionChange("linear")}},c.a.createElement("input",{type:"radio",id:"linear",name:"scale",value:"linear",checked:"linear"===this.state.scale}),c.a.createElement("span",{style:{color:"#AAA"}},"Linear")),c.a.createElement("span",{onClick:function(){return e.handleOptionChange("log")}},c.a.createElement("input",{type:"radio",id:"log",name:"scale",value:"log",checked:"log"===this.state.scale}),c.a.createElement("span",{style:{color:"#AAA"}},"Log"))),c.a.createElement("span",{style:{float:"right","margin-right":"1rem"},onClick:function(){return e.handlePerCapitaChange(!e.state.perCapita)}},c.a.createElement("input",{type:"checkbox",id:"perCapita",name:"perCapita",checked:this.state.perCapita}),c.a.createElement("span",{style:{color:"#AAA"}},"Per Million Capita")),c.a.createElement("span",{style:{float:"right","margin-right":"1rem"},onClick:function(){return e.handleRollingAverageChange(!e.state.rollingAverage)}},c.a.createElement("input",{type:"checkbox",id:"rollingAverage",name:"rollingAverage",checked:this.state.rollingAverage}),c.a.createElement("span",{style:{color:"#AAA"}},"7 day rolling average"))),c.a.createElement(D.d,{height:800,className:"chart-container"},c.a.createElement(D.c,{width:800,height:800,data:t,margin:{top:25,right:25,left:25,bottom:25}},this.state.chartLines.filter((function(a){return!e.state.disabled.includes(a.dataKey)})).map((function(e){return c.a.createElement(D.b,{connectNulls:!0,name:"".concat(e.country," ").concat(e.label.toLowerCase()),type:"monotone",dataKey:e.dataKey.includes("total")?"".concat(e.dataKey).concat(n):"".concat(e.dataKey).concat(n).concat(r),stroke:e.color,yAxisId:0,dot:{r:2}})})),c.a.createElement(D.h,{dataKey:"date",textAnchor:"end",tick:{angle:-70,fontSize:20},height:225,padding:{right:3,left:3}}),c.a.createElement(D.i,{dataKey:o,domain:"log"===this.state.scale?[1,"dataMax"]:[0,"dataMax"],tick:{angle:-45,fontSize:15},width:40,scale:this.state.scale,allowDataOverflow:!0,padding:{top:3,bottom:3}}),c.a.createElement(D.g,{formatter:function(a,t){return[null===a?0:a,"".concat(t," ").concat(e.state.perCapita?"per million":"")]},itemSorter:function(e){return-e.value},filterNull:!1,wrapperStyle:{borderColor:"white",boxShadow:"2px 2px 3px 0px rgb(204, 204, 204)"},contentStyle:{backgroundColor:"rgba(255, 255, 255, 0.8)"},labelStyle:{fontWeight:"bold",color:"#666666"}}),c.a.createElement(D.a,{wrapperStyle:{top:550},align:"center",height:100,content:this.renderCustomizedLegend,payload:this.state.chartLines}))))}}],[{key:"getDerivedStateFromProps",value:function(e,a){var t,n,c=e.dataPoints,r=e.countries;if(!c||a.prevCountries===r)return null;if(a.prevCountries){for(var o=new Set(a.prevCountries),l=new Set(r),s=(t=o,n=l,new Set(Object(w.a)(t).filter((function(e){return!n.has(e)})))),i=a.chartLines.length-1;i>=0;i--)s.has(a.chartLines[i].country)&&(k.push(a.chartLines[i].color),a.chartLines.splice(a.chartLines.indexOf(a.chartLines[i]),1));for(var u=a.disabled.length-1;u>=0;u--){var h,d=!1,p=Object(C.a)(s);try{for(p.s();!(h=p.n()).done;){var v=h.value;a.disabled[u].includes(v)&&(d=!0)}}catch(D){p.e(D)}finally{p.f()}d&&a.disabled.splice(a.disabled.indexOf(a.disabled[u]),1)}}var f,g=a.chartLines||[],m=a.disabled||[],b=Object(C.a)(r);try{for(b.s();!(f=b.n()).done;){var y=f.value;(!a.prevCountries||a.prevCountries&&!a.prevCountries.includes(y))&&(g.push({country:y,dataKey:"newCases".concat(y),color:k.pop(),label:"New cases"}),g.push({country:y,dataKey:"newDeaths".concat(y),color:k.pop(),label:"New deaths"}),g.push({country:y,dataKey:"totalCases".concat(y),color:k.pop(),label:"Total cases"}),g.push({country:y,dataKey:"totalDeaths".concat(y),color:k.pop(),label:"Total deaths"}),m.push("totalCases".concat(y)),m.push("totalDeaths".concat(y)))}}catch(D){b.e(D)}finally{b.f()}return{chartLines:g,disabled:m,prevCountries:r,yLabelPrioritizedKeys:function(e,a){var t,n={},c=Object(C.a)(a);try{for(c.s();!(t=c.n()).done;){var r=t.value;n["newCases".concat(r)]=0,n["totalCases".concat(r)]=0,n["totalDeaths".concat(r)]=0,n["newDeaths".concat(r)]=0,n["newCases".concat(r,"PerCapita")]=0,n["totalCases".concat(r,"PerCapita")]=0,n["totalDeaths".concat(r,"PerCapita")]=0,n["newDeaths".concat(r,"PerCapita")]=0,n["newCases".concat(r,"Rolling")]=0,n["newDeaths".concat(r,"Rolling")]=0,n["newCases".concat(r,"PerCapitaRolling")]=0,n["newDeaths".concat(r,"PerCapitaRolling")]=0;var o,l=Object(C.a)(e);try{for(l.s();!(o=l.n()).done;){var s=o.value;s["newCases".concat(r)]>n["newCases".concat(r)]&&(n["newCases".concat(r)]=s["newCases".concat(r)],n["newCases".concat(r,"PerCapita")]=s["newCases".concat(r,"PerCapita")]),s["totalCases".concat(r)]>n["totalCases".concat(r)]&&(n["totalCases".concat(r)]=s["totalCases".concat(r)],n["totalCases".concat(r,"PerCapita")]=s["totalCases".concat(r,"PerCapita")]),s["totalDeaths".concat(r)]>n["totalDeaths".concat(r)]&&(n["totalDeaths".concat(r)]=s["totalDeaths".concat(r)],n["totalDeaths".concat(r,"PerCapita")]=s["totalDeaths".concat(r,"PerCapita")]),s["newDeaths".concat(r)]>n["newDeaths".concat(r)]&&(n["newDeaths".concat(r)]=s["newDeaths".concat(r)],n["newDeaths".concat(r,"PerCapita")]=s["newDeaths".concat(r,"PerCapita")]),s["newDeaths".concat(r,"Rolling")]>n["newDeaths".concat(r,"Rolling")]&&(n["newDeaths".concat(r,"Rolling")]=s["newDeaths".concat(r,"Rolling")],n["newDeaths".concat(r,"PerCapitaRolling")]=s["newDeaths".concat(r,"PerCapitaRolling")]),s["newCases".concat(r,"Rolling")]>n["newCases".concat(r,"Rolling")]&&(n["newCases".concat(r,"Rolling")]=s["newCases".concat(r,"Rolling")],n["newCases".concat(r,"PerCapitaRolling")]=s["newCases".concat(r,"PerCapitaRolling")])}}catch(D){l.e(D)}finally{l.f()}}}catch(D){c.e(D)}finally{c.f()}return Object.keys(n).map((function(e){return{key:e,value:n[e]}})).sort((function(e,a){return a.value-e.value})).map((function(e){return e.key}))}(c,r)}}}]),t}(n.Component),O=function(e){return 0===Number(e)?null:Number(e)},P=[{value:"Italy",label:"Italy"},{value:"Spain",label:"Spain"}],F=function(e,a){var t={},n={},c=String(e).split("\n"),r=String(a).split("\n"),o={};r.splice(1,r.length).map((function(e){var a=e.split(","),t=Object(g.a)(a,5),n=t[1],c=t[4];o[n]=c}));var l,s=!0,i={},u=Object(C.a)(c);try{for(u.s();!(l=u.n()).done;){var h=l.value;if(s)s=!1;else{var d=h.split(","),p=Object(g.a)(d,6),v=p[0],m=p[1],b=p[2],y=p[3],w=p[4],D=p[5];if(m){var k,E=o[m];if(n[m]=!0,!i[m]){if(0===Number(b)&&0===Number(y)&&0===Number(w)&&0===Number(D))continue;i[m]=!0}if(t[v])t[v]["newCases".concat(m)]=O(b),t[v]["newDeaths".concat(m)]=O(y),t[v]["totalCases".concat(m)]=O(w),t[v]["totalDeaths".concat(m)]=O(D),t[v]["popData".concat(m)]=O(E);else t[v]=(k={date:v},Object(f.a)(k,"newCases".concat(m),O(b)),Object(f.a)(k,"newDeaths".concat(m),O(y)),Object(f.a)(k,"totalCases".concat(m),O(w)),Object(f.a)(k,"totalDeaths".concat(m),O(D)),Object(f.a)(k,"popData".concat(m),O(E)),k)}}}}catch(P){u.e(P)}finally{u.f()}return[Object.values(t).sort((function(e,a){return e.date.localeCompare(a.date)})),Object.keys(n)]},j=function(e,a,t,n,c,r,o){var l=[{useDataKey:"newCases".concat(e.value),newDataKey:"newCases".concat(e.value,"Rolling"),sum:0,entries:0,dataToday:a},{useDataKey:"newDeaths".concat(e.value),newDataKey:"newDeaths".concat(e.value,"Rolling"),sum:0,entries:0,dataToday:t},{useDataKey:"newCases".concat(e.value,"PerCapita"),newDataKey:"newCases".concat(e.value,"PerCapitaRolling"),sum:0,entries:0,dataToday:n},{useDataKey:"newDeaths".concat(e.value,"PerCapita"),newDataKey:"newDeaths".concat(e.value,"PerCapitaRolling"),sum:0,entries:0,dataToday:c}];if(r.length>=6){var s,i=Object(C.a)(l);try{for(i.s();!(s=i.n()).done;){for(var u=s.value,h=0;h<6;h++){var d=r[r.length-h-1][u.useDataKey];null==d||isNaN(d)||(u.sum+=d,u.entries+=1)}u.dataToday&&!isNaN(u.dataToday)&&(u.sum+=u.dataToday,u.entries+=1),o[u.newDataKey]=Number(Number(u.sum/u.entries).toFixed(2))}}catch(p){i.e(p)}finally{i.f()}}},A={option:function(e,a){return Object(v.a)(Object(v.a)({},e),{},{color:a.isSelected?"orange":"black"})}},x=function(e){Object(d.a)(t,e);var a=Object(p.a)(t);function t(){var e;return Object(u.a)(this,t),(e=a.call(this)).state={selectableCountries:P,currentCountries:P},e}return Object(h.a)(t,[{key:"componentDidMount",value:function(){var e=Object(i.a)(s.a.mark((function e(){var a,t,n,c,r,o,l,i,u;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([b.a.get("".concat("https://raw.githubusercontent.com/owid/covid-19-data/master/public/data/ecdc/full_data.csv")),b.a.get("".concat("https://raw.githubusercontent.com/owid/covid-19-data/master/public/data/ecdc/locations.csv"))]);case 2:return a=e.sent,t=Object(g.a)(a,2),n=t[0],c=t[1],r=F(n.data,c.data),o=Object(g.a)(r,2),l=o[0],i=o[1],u=i.map((function(e){return{value:e,label:e}})),this.setState({selectableCountries:u,newParsedData:l}),e.next=11,this.getData(P);case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getData",value:function(){var e=Object(i.a)(s.a.mark((function e(a){var t,n,c,r,o,l,i,u,h,d,p,v,f;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a&&0!==a.length){e.next=3;break}return this.setState({currentCountries:[],multiCountryData:[]}),e.abrupt("return");case 3:t=this.state.newParsedData,n=[],c=!1,r=0,o=Object.values(t);case 7:if(!(r<o.length)){e.next=32;break}if(l=o[r],c){e.next=28;break}i=Object(C.a)(a),e.prev=11,i.s();case 13:if((u=i.n()).done){e.next=20;break}if(h=u.value,!l["newCases".concat(h.value)]){e.next=18;break}return c=!0,e.abrupt("break",20);case 18:e.next=13;break;case 20:e.next=25;break;case 22:e.prev=22,e.t0=e.catch(11),i.e(e.t0);case 25:return e.prev=25,i.f(),e.finish(25);case 28:if(c){d={},[],p=Object(C.a)(a);try{for(f=function(){var e=v.value,a=l["newCases".concat(e.value)]||null,t=l["newDeaths".concat(e.value)]||null,c=l["totalCases".concat(e.value)]||null,r=l["totalDeaths".concat(e.value)]||null;d["newCases".concat(e.value)]=a,d["newDeaths".concat(e.value)]=t,d["totalCases".concat(e.value)]=c,d["totalDeaths".concat(e.value)]=r;var o=l["popData".concat(e.value)]||null;o||"World"!==e.value||(o=7794798729);var s=[a,t,c,r].map((function(e){return Number(Number(e/o*1e6).toFixed(2))||null})),i=Object(g.a)(s,4),u=i[0],h=i[1],p=i[2],f=i[3];d["newCases".concat(e.value,"PerCapita")]=u,d["newDeaths".concat(e.value,"PerCapita")]=h,d["totalCases".concat(e.value,"PerCapita")]=p,d["totalDeaths".concat(e.value,"PerCapita")]=f,j(e,a,t,u,h,n,d)},p.s();!(v=p.n()).done;)f()}catch(s){p.e(s)}finally{p.f()}d.date=l.date,n.push(d)}case 29:r++,e.next=7;break;case 32:this.setState({currentCountries:a,multiCountryData:n});case 33:case"end":return e.stop()}}),e,this,[[11,22,25,28]])})));return function(a){return e.apply(this,arguments)}}()},{key:"_onChange",value:function(){var e=Object(i.a)(s.a.mark((function e(a){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getData(a);case 2:case"end":return e.stop()}}),e,this)})));return function(a){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,a=this.state,t=a.selectableCountries,n=a.currentCountries,r=a.multiCountryData;return console.log(r),c.a.createElement("div",{className:"App"},c.a.createElement("div",{className:"Top-left"},"Source code on: ",c.a.createElement("a",{href:"https://github.com/mathiastj/corona-graphs"},"GitHub")),c.a.createElement("div",{className:"Top-right"},"Sources: ECDC via ",c.a.createElement("a",{href:"https://github.com/owid/covid-19-data"},"OWID")," under"," ",c.a.createElement("a",{href:"https://creativecommons.org/licenses/by/4.0/"},"CC BY 4.0")),c.a.createElement("header",{className:"App-header"},c.a.createElement("div",{style:{width:"80%"}},c.a.createElement(y.a,{isMulti:!0,options:t,onChange:function(a){return e._onChange(a)},defaultValue:P,styles:A,value:n})),c.a.createElement("div",{style:{width:"99%",height:"90%"}},!r&&"Loading...",c.a.createElement(E,{dataPoints:r,countries:n.map((function(e){return e.value}))}))))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(c.a.createElement(x,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[191,1,2]]]);
//# sourceMappingURL=main.7c2bd841.chunk.js.map