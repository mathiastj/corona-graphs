(this["webpackJsonpcorona-graphs"]=this["webpackJsonpcorona-graphs"]||[]).push([[0],{191:function(t,a,e){t.exports=e(394)},196:function(t,a,e){},198:function(t,a,e){},394:function(t,a,e){"use strict";e.r(a);var c=e(1),n=e.n(c),o=e(15),r=e.n(o),l=(e(196),e(23)),i=e.n(l),s=e(61),u=e(55),d=e(56),h=e(60),p=e(59),v=e(88),f=e(10),m=e(8),b=e(20),y=(e(198),e(89)),g=e.n(y),C=e(160),O=e(161),k="newCases",j="newDeaths",w="totalDeaths",E="totalCases",F="Rolling",A="PerCapita",x=e(12),D=["#426600","#FF0010","#990000","#E0FF66","#FFFF80","#F0A3FF","#993F00","#005C31","#2BCE48","#FFCC99","#808080","#94FFB5","#8F7C00","#FFA405","#5EF1F2","#9DCC00","#FFFFFF","#C20088","#FFA8BB","#0075DC","#00998F","#740AFF","#FFFF00","#FF5005"],N=[E,w],S=function(t){Object(h.a)(e,t);var a=Object(p.a)(e);function e(t){var c;return Object(u.a)(this,e),(c=a.call(this,t)).renderCustomizedLegend=function(t){var a=t.payload,e="",o=null;return n.a.createElement("div",{className:"customized-legend",style:{marginBottom:40}},a.map((function(t){e!==t.country?(e=t.country,o=n.a.createElement("span",{className:"Legend-country"},n.a.createElement("br",null),t.country,n.a.createElement("br",null))):o=null;var a=t.dataKey,r=t.color,l=t.label,i=c.state.disabled.includes(a);return n.a.createElement("span",null,o,n.a.createElement("span",{onClick:function(){return c.handleClick(a)},style:{marginRight:10,color:"#AAA"}},n.a.createElement(x.e,{width:20,height:20,style:{marginBottom:-5}},n.a.createElement(x.f,{cx:10,cy:10,type:"circle",size:50,fill:r})),n.a.createElement("input",{type:"checkbox",checked:!i}),n.a.createElement("span",{className:"Legend-per-country"},l)))})))},c.getMaxNonDisabled=function(){var t,a=Object(m.a)(c.state.yLabelPrioritizedKeys);try{for(a.s();!(t=a.n()).done;){var e=t.value;if(c.state.perCapita||c.state.rollingAverage){if(c.state.perCapita&&c.state.rollingAverage){if((!e.includes("total")||!e.includes("".concat(A)))&&!e.includes("".concat(A).concat(F)))continue}else if(!c.state.perCapita&&c.state.rollingAverage){if(e.includes("".concat(A))||e.includes("new")&&!e.includes("".concat(F)))continue}else if(c.state.perCapita&&!c.state.rollingAverage&&(!e.includes("".concat(A))||e.includes("".concat(F))))continue}else if(e.includes("".concat(A))||e.includes("".concat(F)))continue;var n,o=!1,r=Object(m.a)(c.state.disabled);try{for(r.s();!(n=r.n()).done;){var l=n.value;if(e.includes(l)){o=!0;break}}}catch(i){r.e(i)}finally{r.f()}if(!o)return e}}catch(i){a.e(i)}finally{a.f()}return""},c.state={scale:"linear",perCapita:!1,rollingAverage:!1},c}return Object(d.a)(e,[{key:"handleClick",value:function(t){this.state.disabled.includes(t)?this.setState({disabled:this.state.disabled.filter((function(a){return a!==t}))}):this.setState({disabled:this.state.disabled.concat(t)})}},{key:"handleOptionChange",value:function(t){this.setState({scale:t}),this.forceUpdate()}},{key:"handlePerCapitaChange",value:function(t){this.setState({perCapita:t}),this.forceUpdate()}},{key:"handleRollingAverageChange",value:function(t){this.setState({rollingAverage:t}),this.forceUpdate()}},{key:"render",value:function(){var t=this,a=this.props.dataPoints;if(!a)return null;var e=a,c=this.state.perCapita?"".concat(A):"",o=this.state.rollingAverage?"".concat(F):"",r=[0,"dataMax"];"log"===this.state.scale&&this.state.perCapita?r=[.01,"dataMax"]:"log"!==this.state.scale||this.state.perCapita||(r=[1,"dataMax"]);var l=this.getMaxNonDisabled();return n.a.createElement("div",null,n.a.createElement("div",{style:{width:"85%",display:"inline-block"}},n.a.createElement("span",{style:{float:"left","margin-left":"1rem"}},n.a.createElement("span",{onClick:function(){return t.handleOptionChange("linear")}},n.a.createElement("input",{type:"radio",id:"linear",name:"scale",value:"linear",checked:"linear"===this.state.scale}),n.a.createElement("span",{style:{color:"#AAA"}},"Linear")),n.a.createElement("span",{onClick:function(){return t.handleOptionChange("log")}},n.a.createElement("input",{type:"radio",id:"log",name:"scale",value:"log",checked:"log"===this.state.scale}),n.a.createElement("span",{style:{color:"#AAA"}},"Log"))),n.a.createElement("span",{style:{float:"right","margin-right":"1rem"},onClick:function(){return t.handlePerCapitaChange(!t.state.perCapita)}},n.a.createElement("input",{type:"checkbox",id:"perCapita",name:"perCapita",checked:this.state.perCapita}),n.a.createElement("span",{style:{color:"#AAA"}},"Per Million Capita")),n.a.createElement("span",{style:{float:"right","margin-right":"1rem"},onClick:function(){return t.handleRollingAverageChange(!t.state.rollingAverage)}},n.a.createElement("input",{type:"checkbox",id:"rollingAverage",name:"rollingAverage",checked:this.state.rollingAverage}),n.a.createElement("span",{style:{color:"#AAA"}},"7 day rolling average"))),n.a.createElement(x.d,{height:800,className:"chart-container"},n.a.createElement(x.c,{width:800,height:800,data:e,margin:{top:25,right:25,left:25,bottom:25}},this.state.chartLines.filter((function(a){return!t.state.disabled.includes(a.dataKey)})).map((function(t){return n.a.createElement(x.b,{connectNulls:!0,name:"".concat(t.country," ").concat(t.label.toLowerCase()),type:"monotone",dataKey:t.dataKey.includes("total")?"".concat(t.dataKey).concat(c):"".concat(t.dataKey).concat(c).concat(o),stroke:t.color,yAxisId:0,dot:{r:2}})})),n.a.createElement(x.h,{dataKey:"date",textAnchor:"end",tick:{angle:-70,fontSize:20},height:225,padding:{right:3,left:3}}),n.a.createElement(x.i,{dataKey:l,domain:r,tick:{angle:-45,fontSize:15},width:40,scale:this.state.scale,allowDataOverflow:!0,padding:{top:3,bottom:3}}),n.a.createElement(x.g,{formatter:function(a,e){return[null===a?0:a,"".concat(e," ").concat(t.state.perCapita?"per million":"")]},itemSorter:function(t){return-t.value},filterNull:!1,wrapperStyle:{borderColor:"white",boxShadow:"2px 2px 3px 0px rgb(204, 204, 204)"},contentStyle:{backgroundColor:"rgba(255, 255, 255, 0.8)"},labelStyle:{fontWeight:"bold",color:"#666666"}}),n.a.createElement(x.a,{wrapperStyle:{top:550},align:"center",height:100,content:this.renderCustomizedLegend,payload:this.state.chartLines}))))}}],[{key:"getDerivedStateFromProps",value:function(t,a){var e,c,n=t.dataPoints,o=t.countries;if(!n||a.prevCountries===o)return null;if(a.prevCountries){for(var r=new Set(a.prevCountries),l=new Set(o),i=(e=r,c=l,new Set(Object(O.a)(e).filter((function(t){return!c.has(t)})))),s=a.chartLines.length-1;s>=0;s--)i.has(a.chartLines[s].country)&&(D.push(a.chartLines[s].color),a.chartLines.splice(a.chartLines.indexOf(a.chartLines[s]),1));for(var u=a.disabled.length-1;u>=0;u--){var d,h=!1,p=Object(m.a)(i);try{for(p.s();!(d=p.n()).done;){var v=d.value;a.disabled[u].includes(v)&&(h=!0)}}catch(B){p.e(B)}finally{p.f()}h&&a.disabled.splice(a.disabled.indexOf(a.disabled[u]),1)}}var y,g=a.chartLines||[],C=a.disabled||[],x=function(t,a){var e,c=[],n=t?t.length:0;if(0===n)return N;var o,r=(e={},Object(f.a)(e,k,0),Object(f.a)(e,j,0),Object(f.a)(e,E,0),Object(f.a)(e,w,0),e),l=Object(m.a)(a);try{for(l.s();!(o=l.n()).done;)for(var i=o.value,s=0,u=Object.keys(r);s<u.length;s++){var d=u[s];i.includes(d)&&r[d]++}}catch(B){l.e(B)}finally{l.f()}for(var h=0,p=Object.entries(r);h<p.length;h++){var v=Object(b.a)(p[h],2),y=v[0],g=v[1];if(g===n)c.push(y);else if(g>0&&g<n)return N}return c}(a.prevCountries,C),S=Object(m.a)(o);try{for(S.s();!(y=S.n()).done;){var K=y.value;if(!a.prevCountries||a.prevCountries&&!a.prevCountries.includes(K)){g.push({country:K,dataKey:"".concat(k).concat(K),color:D.pop(),label:"New cases"}),g.push({country:K,dataKey:"".concat(j).concat(K),color:D.pop(),label:"New deaths"}),g.push({country:K,dataKey:"".concat(E).concat(K),color:D.pop(),label:"Total cases"}),g.push({country:K,dataKey:"".concat(w).concat(K),color:D.pop(),label:"Total deaths"});var L,P=Object(m.a)(x);try{for(P.s();!(L=P.n()).done;){var T=L.value;C.push("".concat(T).concat(K))}}catch(B){P.e(B)}finally{P.f()}}}}catch(B){S.e(B)}finally{S.f()}return{chartLines:g,disabled:C,prevCountries:o,yLabelPrioritizedKeys:function(t,a){var e,c={},n=Object(m.a)(a);try{for(n.s();!(e=n.n()).done;){var o=e.value;c["".concat(k).concat(o)]=0,c["".concat(E).concat(o)]=0,c["".concat(w).concat(o)]=0,c["".concat(j).concat(o)]=0,c["".concat(k).concat(o).concat(A)]=0,c["".concat(E).concat(o).concat(A)]=0,c["".concat(w).concat(o).concat(A)]=0,c["".concat(j).concat(o).concat(A)]=0,c["".concat(k).concat(o).concat(F)]=0,c["".concat(j).concat(o).concat(F)]=0,c["".concat(k).concat(o).concat(A).concat(F)]=0,c["".concat(j).concat(o).concat(A).concat(F)]=0;var r,l=Object(m.a)(t);try{for(l.s();!(r=l.n()).done;){var i=r.value;i["".concat(k).concat(o)]>c["".concat(k).concat(o)]&&(c["".concat(k).concat(o)]=i["".concat(k).concat(o)],c["".concat(k).concat(o).concat(A)]=i["".concat(k).concat(o).concat(A)]),i["".concat(E).concat(o)]>c["".concat(E).concat(o)]&&(c["".concat(E).concat(o)]=i["".concat(E).concat(o)],c["".concat(E).concat(o).concat(A)]=i["".concat(E).concat(o).concat(A)]),i["".concat(w).concat(o)]>c["".concat(w).concat(o)]&&(c["".concat(w).concat(o)]=i["".concat(w).concat(o)],c["".concat(w).concat(o).concat(A)]=i["".concat(w).concat(o).concat(A)]),i["".concat(j).concat(o)]>c["".concat(j).concat(o)]&&(c["".concat(j).concat(o)]=i["".concat(j).concat(o)],c["".concat(j).concat(o).concat(A)]=i["".concat(j).concat(o).concat(A)]),i["".concat(j).concat(o).concat(F)]>c["".concat(j).concat(o).concat(F)]&&(c["".concat(j).concat(o).concat(F)]=i["".concat(j).concat(o).concat(F)],c["".concat(j).concat(o).concat(A).concat(F)]=i["".concat(j).concat(o).concat(A).concat(F)]),i["".concat(k).concat(o).concat(F)]>c["".concat(k).concat(o).concat(F)]&&(c["".concat(k).concat(o).concat(F)]=i["".concat(k).concat(o).concat(F)],c["".concat(k).concat(o).concat(A).concat(F)]=i["".concat(k).concat(o).concat(A).concat(F)])}}catch(B){l.e(B)}finally{l.f()}}}catch(B){n.e(B)}finally{n.f()}return Object.keys(c).map((function(t){return{key:t,value:c[t]}})).sort((function(t,a){return a.value-t.value})).map((function(t){return t.key}))}(n,o)}}}]),e}(c.Component),K=function(t){return 0===Number(t)?null:Number(t)},L=[{value:"Italy",label:"Italy"},{value:"Spain",label:"Spain"}],P=function(t,a){var e={},c={},n=String(t).split("\n"),o=String(a).split("\n"),r={};o.splice(1,o.length).map((function(t){var a=t.split(","),e=Object(b.a)(a,5),c=e[1],n=e[4];r[c]=n}));var l,i=!0,s={},u=Object(m.a)(n);try{for(u.s();!(l=u.n()).done;){var d=l.value;if(i)i=!1;else{var h=d.split(","),p=Object(b.a)(h,9),v=p[2],y=p[3],g=p[4],C=p[5],O=p[7],F=p[8];if(v){var A,x=r[v];if(c[v]=!0,!s[v]){if(0===Number(C)&&0===Number(F)&&0===Number(g)&&0===Number(O))continue;s[v]=!0}if(e[y])e[y]["".concat(k).concat(v)]=K(C),e[y]["".concat(j).concat(v)]=K(F),e[y]["".concat(E).concat(v)]=K(g),e[y]["".concat(w).concat(v)]=K(O),e[y]["popData".concat(v)]=K(x);else e[y]=(A={date:y},Object(f.a)(A,"".concat(k).concat(v),K(C)),Object(f.a)(A,"".concat(j).concat(v),K(F)),Object(f.a)(A,"".concat(E).concat(v),K(g)),Object(f.a)(A,"".concat(w).concat(v),K(O)),Object(f.a)(A,"popData".concat(v),K(x)),A)}}}}catch(D){u.e(D)}finally{u.f()}return[Object.values(e).sort((function(t,a){return t.date.localeCompare(a.date)})),Object.keys(c)]},T=function(t,a,e,c,n,o,r){var l=[{useDataKey:"".concat(k).concat(t.value),newDataKey:"".concat(k).concat(t.value).concat(F),sum:0,entries:0,dataToday:a},{useDataKey:"".concat(j).concat(t.value),newDataKey:"".concat(j).concat(t.value).concat(F),sum:0,entries:0,dataToday:e},{useDataKey:"".concat(k).concat(t.value).concat(A),newDataKey:"".concat(k).concat(t.value).concat(A).concat(F),sum:0,entries:0,dataToday:c},{useDataKey:"".concat(j).concat(t.value).concat(A),newDataKey:"".concat(j).concat(t.value).concat(A).concat(F),sum:0,entries:0,dataToday:n}];if(o.length>=6){var i,s=Object(m.a)(l);try{for(s.s();!(i=s.n()).done;){for(var u=i.value,d=0;d<6;d++){var h=o[o.length-d-1][u.useDataKey];null==h||isNaN(h)||(u.sum+=h,u.entries+=1)}u.dataToday&&!isNaN(u.dataToday)&&(u.sum+=u.dataToday,u.entries+=1),r[u.newDataKey]=Number(Number(u.sum/u.entries).toFixed(2))}}catch(p){s.e(p)}finally{s.f()}}},B={option:function(t,a){return Object(v.a)(Object(v.a)({},t),{},{color:a.isSelected?"orange":"black"})}},z=function(t){Object(h.a)(e,t);var a=Object(p.a)(e);function e(){var t;return Object(u.a)(this,e),(t=a.call(this)).state={selectableCountries:L,currentCountries:L},t}return Object(d.a)(e,[{key:"componentDidMount",value:function(){var t=Object(s.a)(i.a.mark((function t(){var a,e,c,n,o,r,l,s,u;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all([g.a.get("".concat("https://raw.githubusercontent.com/owid/covid-19-data/master/public/data/owid-covid-data.csv")),g.a.get("".concat("https://raw.githubusercontent.com/owid/covid-19-data/master/public/data/ecdc/locations.csv"))]);case 2:return a=t.sent,e=Object(b.a)(a,2),c=e[0],n=e[1],o=P(c.data,n.data),r=Object(b.a)(o,2),l=r[0],s=r[1],u=s.map((function(t){return{value:t,label:t}})),this.setState({selectableCountries:u,newParsedData:l}),t.next=11,this.getData(L);case 11:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"getData",value:function(){var t=Object(s.a)(i.a.mark((function t(a){var e,c,n,o,r,l,s,u,d,h,p,v,f;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a&&0!==a.length){t.next=3;break}return this.setState({currentCountries:[],multiCountryData:[]}),t.abrupt("return");case 3:e=this.state.newParsedData,c=[],n=!1,o=0,r=Object.values(e);case 7:if(!(o<r.length)){t.next=32;break}if(l=r[o],n){t.next=28;break}s=Object(m.a)(a),t.prev=11,s.s();case 13:if((u=s.n()).done){t.next=20;break}if(d=u.value,!l["".concat(k).concat(d.value)]){t.next=18;break}return n=!0,t.abrupt("break",20);case 18:t.next=13;break;case 20:t.next=25;break;case 22:t.prev=22,t.t0=t.catch(11),s.e(t.t0);case 25:return t.prev=25,s.f(),t.finish(25);case 28:if(n){h={},p=Object(m.a)(a);try{for(f=function(){var t=v.value,a=l["".concat(k).concat(t.value)]||null,e=l["".concat(j).concat(t.value)]||null,n=l["".concat(E).concat(t.value)]||null,o=l["".concat(w).concat(t.value)]||null;h["".concat(k).concat(t.value)]=a,h["".concat(j).concat(t.value)]=e,h["".concat(E).concat(t.value)]=n,h["".concat(w).concat(t.value)]=o;var r=l["popData".concat(t.value)]||null;r||"World"!==t.value||(r=7794798729);var i=[a,e,n,o].map((function(t){return Number(Number(t/r*1e6).toFixed(2))||null})),s=Object(b.a)(i,4),u=s[0],d=s[1],p=s[2],f=s[3];h["".concat(k).concat(t.value).concat(A)]=u,h["".concat(j).concat(t.value).concat(A)]=d,h["".concat(E).concat(t.value).concat(A)]=p,h["".concat(w).concat(t.value).concat(A)]=f,T(t,a,e,u,d,c,h)},p.s();!(v=p.n()).done;)f()}catch(i){p.e(i)}finally{p.f()}h.date=l.date,c.push(h)}case 29:o++,t.next=7;break;case 32:this.setState({currentCountries:a,multiCountryData:c});case 33:case"end":return t.stop()}}),t,this,[[11,22,25,28]])})));return function(a){return t.apply(this,arguments)}}()},{key:"_onChange",value:function(){var t=Object(s.a)(i.a.mark((function t(a){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getData(a);case 2:case"end":return t.stop()}}),t,this)})));return function(a){return t.apply(this,arguments)}}()},{key:"render",value:function(){var t=this,a=this.state,e=a.selectableCountries,c=a.currentCountries,o=a.multiCountryData;return console.log(o),n.a.createElement("div",{className:"App"},n.a.createElement("div",{className:"Top-left"},"Source code on: ",n.a.createElement("a",{href:"https://github.com/mathiastj/corona-graphs"},"GitHub")),n.a.createElement("div",{className:"Top-right"},"Sources: ",n.a.createElement("a",{href:"https://github.com/owid/covid-19-data/tree/master/public/data"},"OWID")," under"," ",n.a.createElement("a",{href:"https://creativecommons.org/licenses/by/4.0/"},"CC BY 4.0")),n.a.createElement("header",{className:"App-header"},n.a.createElement("div",{style:{width:"80%"}},n.a.createElement(C.a,{isMulti:!0,options:e,onChange:function(a){return t._onChange(a)},defaultValue:L,styles:B,value:c})),n.a.createElement("div",{style:{width:"99%",height:"90%"}},!o&&"Loading...",n.a.createElement(S,{dataPoints:o,countries:c.map((function(t){return t.value}))}))))}}]),e}(c.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(n.a.createElement(z,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))}},[[191,1,2]]]);
//# sourceMappingURL=main.c7ef581f.chunk.js.map